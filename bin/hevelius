#!/usr/bin/env python3

"""
Provides command line interface to the Hevelius project.
"""

import sys
import argparse

sys.path.append(".")

from hevelius.cmd_basic import stats, db_version, hevelius_version, config_show
from hevelius.cmd_db_migrate import migrate
from hevelius.cmd_repo import repo

if __name__ == '__main__':
    print(f"Hevelius {hevelius_version()}")
    print()

    parser = argparse.ArgumentParser("hevelius")
    subparsers = parser.add_subparsers(help="commands", dest="command")

    stats_parser = subparsers.add_parser('stats', help="Show database statistics")
    migrate_parser = subparsers.add_parser('migrate', help="Migrate to the latest DB schema")
    version_parser = subparsers.add_parser('version', help="Shows the current DB schema version.")
    config_parser = subparsers.add_parser('config', help="Shows current DB configuration.")
    repo_parser = subparsers.add_parser('repo', help="Manages files repository on local storage.")

    args = parser.parse_args()

    if args.command == "stats":
        stats() # see cmd_basic.py
    elif args.command == "migrate":
        migrate(args) # see cmd_db_migrate.py
    elif args.command == "version":
        db_version() # see cmd_basic.py
    elif args.command == "config":
        config_show() # see cmd_basic.py
    elif args.command == "repo":
        repo(args) # see cmd_repo.py

    else:
        parser.print_help()
